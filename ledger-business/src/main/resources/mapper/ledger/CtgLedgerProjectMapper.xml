<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ledger.business.mapper.CtgLedgerProjectMapper">
    
    <resultMap type="CtgLedgerProject" id="CtgLedgerProjectResult">
        <result property="id"    column="id"    />
        <result property="projectName"    column="project_name"    />
        <result property="projectCode"    column="project_code"    />
        <result property="extendProjectId"    column="extend_project_id"    />
        <result property="equipPurchaseFee"    column="equip_purchase_fee"    />
        <result property="protoEquipFee"    column="proto_equip_fee"    />
        <result property="equipRenovFee"    column="equip_renov_fee"    />
        <result property="equipRentFee"    column="equip_rent_fee"    />
        <result property="materialCost"    column="material_cost"    />
        <result property="testProcFee"    column="test_proc_fee"    />
        <result property="fuelPowerCost"    column="fuel_power_cost"    />
        <result property="pubDocIpFee"    column="pub_doc_ip_fee"    />
        <result property="travelConfCoopFee"    column="travel_conf_coop_fee"    />
        <result property="laborCost"    column="labor_cost"    />
        <result property="serviceCost"    column="service_cost"    />
        <result property="expertConsultFee"    column="expert_consult_fee"    />
        <result property="mgmtFee"    column="mgmt_fee"    />
        <result property="taxFee"    column="tax_fee"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
        <!-- 新增的已执行字段 -->
        <result property="executedEquipPurchaseFee" column="executed_equip_purchase_fee" />
        <result property="executedProtoEquipFee" column="executed_proto_equip_fee" />
        <result property="executedEquipRenovFee" column="executed_equip_renov_fee" />
        <result property="executedEquipRentFee" column="executed_equip_rent_fee" />
        <result property="executedMaterialCost" column="executed_material_cost" />
        <result property="executedTestProcFee" column="executed_test_proc_fee" />
        <result property="executedFuelPowerCost" column="executed_fuel_power_cost" />
        <result property="executedPubDocIpFee" column="executed_pub_doc_ip_fee" />
        <result property="executedTravelConfCoopFee" column="executed_travel_conf_coop_fee" />
        <result property="executedLaborCost" column="executed_labor_cost" />
        <result property="executedServiceCost" column="executed_service_cost" />
        <result property="executedExpertConsultFee" column="executed_expert_consult_fee" />
        <result property="executedMgmtFee" column="executed_mgmt_fee" />
        <result property="executedTaxFee" column="executed_tax_fee" />
        <result property="projectManagerLoginName" column="project_manager_login_name" />
        <!-- 新增的合同金额字段 -->
        <result property="contractAmount" column="contract_amount" />
        <result property="executedContractAmount" column="executed_contract_amount" />
    </resultMap>

    <sql id="selectCtgLedgerProjectVo">
        select id, project_name, project_code, extend_project_id, equip_purchase_fee, proto_equip_fee, equip_renov_fee, equip_rent_fee, material_cost, test_proc_fee, fuel_power_cost, pub_doc_ip_fee, travel_conf_coop_fee, labor_cost, service_cost, expert_consult_fee, mgmt_fee, tax_fee, create_by, create_time, update_by, update_time, executed_equip_purchase_fee, executed_proto_equip_fee, executed_equip_renov_fee, executed_equip_rent_fee, executed_material_cost, executed_test_proc_fee, executed_fuel_power_cost, executed_pub_doc_ip_fee, executed_travel_conf_coop_fee, executed_labor_cost, executed_service_cost, executed_expert_consult_fee, executed_mgmt_fee, executed_tax_fee, project_manager_login_name, contract_amount, executed_contract_amount from ctg_ledger_project
    </sql>

        <select id="selectCtgLedgerProjectList" parameterType="CtgLedgerProject" resultMap="CtgLedgerProjectResult">
        <include refid="selectCtgLedgerProjectVo"/>
        <where>  
            <if test="projectName != null  and projectName != ''"> and project_name like concat('%', #{projectName}, '%')</if>
            <if test="projectCode != null  and projectCode != ''"> and project_code like concat('%', #{projectCode}, '%')</if>
            <!-- 添加keyword查询条件 -->
            <if test="params.keyword != null and params.keyword != ''">
                and (project_name like concat('%', #{params.keyword}, '%') OR project_code like concat('%', #{params.keyword}, '%'))
            </if>
            <if test="extendProjectId != null "> and extend_project_id = #{extendProjectId}</if>
            <if test="equipPurchaseFee != null "> and equip_purchase_fee = #{equipPurchaseFee}</if>
            <if test="protoEquipFee != null "> and proto_equip_fee = #{protoEquipFee}</if>
            <if test="equipRenovFee != null "> and equip_renov_fee = #{equipRenovFee}</if>
            <if test="equipRentFee != null "> and equip_rent_fee = #{equipRentFee}</if>
            <if test="materialCost != null "> and material_cost = #{materialCost}</if>
            <if test="testProcFee != null "> and test_proc_fee = #{testProcFee}</if>
            <if test="fuelPowerCost != null "> and fuel_power_cost = #{fuelPowerCost}</if>
            <if test="pubDocIpFee != null "> and pub_doc_ip_fee = #{pubDocIpFee}</if>
            <if test="travelConfCoopFee != null "> and travel_conf_coop_fee = #{travelConfCoopFee}</if>
            <if test="laborCost != null "> and labor_cost = #{laborCost}</if>
            <if test="serviceCost != null "> and service_cost = #{serviceCost}</if>
            <if test="expertConsultFee != null "> and expert_consult_fee = #{expertConsultFee}</if>
            <if test="mgmtFee != null "> and mgmt_fee = #{mgmtFee}</if>
            <if test="taxFee != null "> and tax_fee = #{taxFee}</if>
            <!-- 已执行字段查询条件 -->
            <if test="executedEquipPurchaseFee != null "> and executed_equip_purchase_fee = #{executedEquipPurchaseFee}</if>
            <if test="executedProtoEquipFee != null "> and executed_proto_equip_fee = #{executedProtoEquipFee}</if>
            <if test="executedEquipRenovFee != null "> and executed_equip_renov_fee = #{executedEquipRenovFee}</if>
            <if test="executedEquipRentFee != null "> and executed_equip_rent_fee = #{executedEquipRentFee}</if>
            <if test="executedMaterialCost != null "> and executed_material_cost = #{executedMaterialCost}</if>
            <if test="executedTestProcFee != null "> and executed_test_proc_fee = #{executedTestProcFee}</if>
            <if test="executedFuelPowerCost != null "> and executed_fuel_power_cost = #{executedFuelPowerCost}</if>
            <if test="executedPubDocIpFee != null "> and executed_pub_doc_ip_fee = #{executedPubDocIpFee}</if>
            <if test="executedTravelConfCoopFee != null "> and executed_travel_conf_coop_fee = #{executedTravelConfCoopFee}</if>
            <if test="executedLaborCost != null "> and executed_labor_cost = #{executedLaborCost}</if>
            <if test="executedServiceCost != null "> and executed_service_cost = #{executedServiceCost}</if>
            <if test="executedExpertConsultFee != null "> and executed_expert_consult_fee = #{executedExpertConsultFee}</if>
            <if test="executedMgmtFee != null "> and executed_mgmt_fee = #{executedMgmtFee}</if>
            <if test="executedTaxFee != null "> and executed_tax_fee = #{executedTaxFee}</if>
            <if test="projectManagerLoginName != null "> and project_manager_login_name = #{projectManagerLoginName}</if>
            <if test="params.ids != null and params.ids.size() > 0">
                and id in
                <foreach item="id" collection="params.ids" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    
    <select id="selectCtgLedgerProjectById" parameterType="Long" resultMap="CtgLedgerProjectResult">
        <include refid="selectCtgLedgerProjectVo"/>
        where id = #{id}
    </select>

    <insert id="insertCtgLedgerProject" parameterType="CtgLedgerProject" useGeneratedKeys="true" keyProperty="id">
        insert into ctg_ledger_project
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="projectName != null and projectName != ''">project_name,</if>
            <if test="projectCode != null">project_code,</if>
            <if test="extendProjectId != null">extend_project_id,</if>
            <if test="equipPurchaseFee != null">equip_purchase_fee,</if>
            <if test="protoEquipFee != null">proto_equip_fee,</if>
            <if test="equipRenovFee != null">equip_renov_fee,</if>
            <if test="equipRentFee != null">equip_rent_fee,</if>
            <if test="materialCost != null">material_cost,</if>
            <if test="testProcFee != null">test_proc_fee,</if>
            <if test="fuelPowerCost != null">fuel_power_cost,</if>
            <if test="pubDocIpFee != null">pub_doc_ip_fee,</if>
            <if test="travelConfCoopFee != null">travel_conf_coop_fee,</if>
            <if test="laborCost != null">labor_cost,</if>
            <if test="serviceCost != null">service_cost,</if>
            <if test="expertConsultFee != null">expert_consult_fee,</if>
            <if test="mgmtFee != null">mgmt_fee,</if>
            <if test="taxFee != null">tax_fee,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
            <!-- 新增的已执行字段 -->
            <if test="executedEquipPurchaseFee != null">executed_equip_purchase_fee,</if>
            <if test="executedProtoEquipFee != null">executed_proto_equip_fee,</if>
            <if test="executedEquipRenovFee != null">executed_equip_renov_fee,</if>
            <if test="executedEquipRentFee != null">executed_equip_rent_fee,</if>
            <if test="executedMaterialCost != null">executed_material_cost,</if>
            <if test="executedTestProcFee != null">executed_test_proc_fee,</if>
            <if test="executedFuelPowerCost != null">executed_fuel_power_cost,</if>
            <if test="executedPubDocIpFee != null">executed_pub_doc_ip_fee,</if>
            <if test="executedTravelConfCoopFee != null">executed_travel_conf_coop_fee,</if>
            <if test="executedLaborCost != null">executed_labor_cost,</if>
            <if test="executedServiceCost != null">executed_service_cost,</if>
            <if test="executedExpertConsultFee != null">executed_expert_consult_fee,</if>
            <if test="executedMgmtFee != null">executed_mgmt_fee,</if>
            <if test="executedTaxFee != null">executed_tax_fee,</if>
            <!-- 新增的项目负责人和合同金额字段 -->
            <if test="projectManagerLoginName != null">project_manager_login_name,</if>
            <if test="contractAmount != null">contract_amount,</if>
            <if test="executedContractAmount != null">executed_contract_amount,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="projectName != null and projectName != ''">#{projectName},</if>
            <if test="projectCode != null">#{projectCode},</if>
            <if test="extendProjectId != null">#{extendProjectId},</if>
            <if test="equipPurchaseFee != null">#{equipPurchaseFee},</if>
            <if test="protoEquipFee != null">#{protoEquipFee},</if>
            <if test="equipRenovFee != null">#{equipRenovFee},</if>
            <if test="equipRentFee != null">#{equipRentFee},</if>
            <if test="materialCost != null">#{materialCost},</if>
            <if test="testProcFee != null">#{testProcFee},</if>
            <if test="fuelPowerCost != null">#{fuelPowerCost},</if>
            <if test="pubDocIpFee != null">#{pubDocIpFee},</if>
            <if test="travelConfCoopFee != null">#{travelConfCoopFee},</if>
            <if test="laborCost != null">#{laborCost},</if>
            <if test="serviceCost != null">#{serviceCost},</if>
            <if test="expertConsultFee != null">#{expertConsultFee},</if>
            <if test="mgmtFee != null">#{mgmtFee},</if>
            <if test="taxFee != null">#{taxFee},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <!-- 新增的已执行字段 -->
            <if test="executedEquipPurchaseFee != null">#{executedEquipPurchaseFee},</if>
            <if test="executedProtoEquipFee != null">#{executedProtoEquipFee},</if>
            <if test="executedEquipRenovFee != null">#{executedEquipRenovFee},</if>
            <if test="executedEquipRentFee != null">#{executedEquipRentFee},</if>
            <if test="executedMaterialCost != null">#{executedMaterialCost},</if>
            <if test="executedTestProcFee != null">#{executedTestProcFee},</if>
            <if test="executedFuelPowerCost != null">#{executedFuelPowerCost},</if>
            <if test="executedPubDocIpFee != null">#{executedPubDocIpFee},</if>
            <if test="executedTravelConfCoopFee != null">#{executedTravelConfCoopFee},</if>
            <if test="executedLaborCost != null">#{executedLaborCost},</if>
            <if test="executedServiceCost != null">#{executedServiceCost},</if>
            <if test="executedExpertConsultFee != null">#{executedExpertConsultFee},</if>
            <if test="executedMgmtFee != null">#{executedMgmtFee},</if>
            <if test="executedTaxFee != null">#{executedTaxFee},</if>
            <!-- 新增的项目负责人和合同金额字段 -->
            <if test="projectManagerLoginName != null">#{projectManagerLoginName},</if>
            <if test="contractAmount != null">#{contractAmount},</if>
            <if test="executedContractAmount != null">#{executedContractAmount},</if>
         </trim>
    </insert>

    <update id="updateCtgLedgerProject" parameterType="CtgLedgerProject">
        update ctg_ledger_project
        <trim prefix="SET" suffixOverrides=",">
            <if test="projectName != null and projectName != ''">project_name = #{projectName},</if>
            <if test="projectCode != null">project_code = #{projectCode},</if>
            <if test="extendProjectId != null">extend_project_id = #{extendProjectId},</if>
            <if test="equipPurchaseFee != null">equip_purchase_fee = #{equipPurchaseFee},</if>
            <if test="protoEquipFee != null">proto_equip_fee = #{protoEquipFee},</if>
            <if test="equipRenovFee != null">equip_renov_fee = #{equipRenovFee},</if>
            <if test="equipRentFee != null">equip_rent_fee = #{equipRentFee},</if>
            <if test="materialCost != null">material_cost = #{materialCost},</if>
            <if test="testProcFee != null">test_proc_fee = #{testProcFee},</if>
            <if test="fuelPowerCost != null">fuel_power_cost = #{fuelPowerCost},</if>
            <if test="pubDocIpFee != null">pub_doc_ip_fee = #{pubDocIpFee},</if>
            <if test="travelConfCoopFee != null">travel_conf_coop_fee = #{travelConfCoopFee},</if>
            <if test="laborCost != null">labor_cost = #{laborCost},</if>
            <if test="serviceCost != null">service_cost = #{serviceCost},</if>
            <if test="expertConsultFee != null">expert_consult_fee = #{expertConsultFee},</if>
            <if test="mgmtFee != null">mgmt_fee = #{mgmtFee},</if>
            <if test="taxFee != null">tax_fee = #{taxFee},</if>
            <if test="createBy != null">create_by = #{createBy},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
            <!-- 新增的已执行字段 -->
            <if test="executedEquipPurchaseFee != null">executed_equip_purchase_fee = #{executedEquipPurchaseFee},</if>
            <if test="executedProtoEquipFee != null">executed_proto_equip_fee = #{executedProtoEquipFee},</if>
            <if test="executedEquipRenovFee != null">executed_equip_renov_fee = #{executedEquipRenovFee},</if>
            <if test="executedEquipRentFee != null">executed_equip_rent_fee = #{executedEquipRentFee},</if>
            <if test="executedMaterialCost != null">executed_material_cost = #{executedMaterialCost},</if>
            <if test="executedTestProcFee != null">executed_test_proc_fee = #{executedTestProcFee},</if>
            <if test="executedFuelPowerCost != null">executed_fuel_power_cost = #{executedFuelPowerCost},</if>
            <if test="executedPubDocIpFee != null">executed_pub_doc_ip_fee = #{executedPubDocIpFee},</if>
            <if test="executedTravelConfCoopFee != null">executed_travel_conf_coop_fee = #{executedTravelConfCoopFee},</if>
            <if test="executedLaborCost != null">executed_labor_cost = #{executedLaborCost},</if>
            <if test="executedServiceCost != null">executed_service_cost = #{executedServiceCost},</if>
            <if test="executedExpertConsultFee != null">executed_expert_consult_fee = #{executedExpertConsultFee},</if>
            <if test="executedMgmtFee != null">executed_mgmt_fee = #{executedMgmtFee},</if>
            <if test="executedTaxFee != null">executed_tax_fee = #{executedTaxFee},</if>
            <!-- 新增的项目负责人和合同金额字段 -->
            <if test="projectManagerLoginName != null">project_manager_login_name = #{projectManagerLoginName},</if>
            <if test="contractAmount != null">contract_amount = #{contractAmount},</if>
            <if test="executedContractAmount != null">executed_contract_amount = #{executedContractAmount},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteCtgLedgerProjectById" parameterType="Long">
        delete from ctg_ledger_project where id = #{id}
    </delete>

    <delete id="deleteCtgLedgerProjectByIds" parameterType="String">
        delete from ctg_ledger_project where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <select id="selectCtgLedgerProjectByProjectName" parameterType="String" resultMap="CtgLedgerProjectResult">
        <include refid="selectCtgLedgerProjectVo"/>
        where project_name = #{projectName}
    </select>
</mapper>